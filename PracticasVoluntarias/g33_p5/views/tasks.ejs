<!-- APLICACIONES WEB. Práctica Voluntaria 1. Grupo 33: Daniel Compán López de Lacalle y Alejandro Moreno Murillo -->
<!DOCTYPE html>
<html lang="es">
    <head>
        <title>AW - Práctica Voluntaria 1 - Grupo 33 : Daniel Compán y Alejandro Moreno</title>
        <link rel="icon" type="image/x-icon" href=".\img\favicon.ico">
        <meta charset="utf-8" />
        <!-- Importar BootStrap Stylesheet -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <meta name="viewport" content="width device width , initial scale =1">
        <!-- Hojas de estilos personalizadas -->
        <link rel="stylesheet" href="./css/tasksScreen.css" media="screen" />
        <link rel="stylesheet" href="./css/tasksPrint.css" media="print" />
        <!-- Fuentes de Google Fonts -->
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Indie+Flower">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Farsan">
    </head>
    <body>
        <div id="ppal">
            <header>
                <div id="cabecera" class="container-fluid">
                    <div class="row align-items-center">
                        <div id="logo" class="col col-sm-6 col-md-7 col-lg-8 col-xl-9">
                            <img src="./img/favicon.ico" />
                        </div>
                        <div id="session" class="col col-sm-6 col-md-5 col-lg-4 col-xl-3">
                            <div class="row align-items-center">
                                <div id="user_avatar" class="col col-6">
                                    <img class="rounded-circle" src="/imagenUsuario"/>
                                </div>
                                <div id="session_menu" class="col col-5 offset-right-1">
                                    <div id="user_name"><%=currentUser%> </div>
                                    <div id="logout_btn">
                                        <a class="btn btn-outline-primary" href="/logout">Desconectar</a>
                                    </div>
                                </div>
                            </div>
                        <div>
                    </div>
                </div>
            </header>
            <div id="contenido" class="container">
                <div id="t_lista">
                    
                    <p id="t_titulo" class="ptr_text">Tareas</p>

                    <%listaTask.forEach(task=>{ %> 

                        <%if(task.done ===0) { %>

                            <div class="row align-items-center tarea pendiente">
                                <div class="col-auto t_nombre"><span class="ptr_text">&nbsp;&nbsp;&nbsp;&nbsp;&#8226;&nbsp;&nbsp;</span><%=task.text;%></div>
                                <%task.tags.forEach(tag=>{ %> 
                                    <div class="col-auto t_etiqueta"><%=tag%></div>
                                <%});%>
                                <div class="col t_relleno"></div>
                                <a class="col-auto btn btn-success t_accion" href="/finish/<%=task.id%>">Marcar finalizada</a>
                            </div>
                        <%}
                        else{%>
                            
                            <div class="row align-items-center tarea completa">
                                <div class="col-auto t_nombre"><span class="ptr_text">&nbsp;&nbsp;&nbsp;&nbsp;&#8226;&nbsp;&nbsp;</span><%=task.text;%></div>
                                <div class="colt_relleno"></div>
                            </div>
                        <%}%>
                    <%});%> 
                </div>
                <div id="t_botones" class="row justify-content-around">
                    <button class="col-auto btn btn-danger"><a href="/deletecompleted">Eliminar Tarea</a></button>
                    <button class="col-auto button btn-primary offset-2" data-modal="modalOne">Nueva tarea</button>
                </div>
                <div id="modalOne" class="modal">
                    <div class="modal-content">
                        <div class="form">
                        <a href="#" class="close">&times;</a>
                        <form method= "POST" action="/addTask">
                            <h3 id="AddTaskTitle" class="mx-auto" style="margin: 1rem">Añadir Tarea</h3>
                            <div>
                            <input class="fname" type="text" name="desc" placeholder="Nombre de la tarea" id="desc"/>
                            </div>
                            <button type="submit">Submit</button>
                        </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Importar BootStrap JavaScript -->
        <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script> -->
        <script>
            let modalBtns = [...document.querySelectorAll(".button")];
            modalBtns.forEach(function (btn) {
                btn.onclick = function () {
                let modal = btn.getAttribute("data-modal");
                document.getElementById(modal).style.display = "block";
                };
            });
            let closeBtns = [...document.querySelectorAll(".close")];
            closeBtns.forEach(function (btn) {
                btn.onclick = function () {
                let modal = btn.closest(".modal");
                modal.style.display = "none";
                };
            });
            window.onclick = function (event) {
                if (event.target.className === "modal") {
                event.target.style.display = "none";
                }
            };
    </script>
    </body>
</html>